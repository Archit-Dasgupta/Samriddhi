<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Samriddhi</title>
  <link rel="stylesheet" href="styles.css"/>
  <style>
    /* Minimal inline styles for new UI bits (dropdown & badges) */
    .dropdown { position: relative; }
    .dropdown-toggle { cursor:pointer; display:inline-flex; align-items:center; gap:6px; }
    .dropdown-menu {
      position:absolute; top:36px; right:0; background:#fff; border:1px solid var(--border);
      border-radius:12px; box-shadow:0 8px 24px rgba(0,0,0,.08); min-width:220px; padding:6px; display:none; z-index:50;
    }
    .dropdown.open .dropdown-menu { display:block; }
    .dropdown-item { display:flex; gap:8px; align-items:center; padding:10px 12px; border-radius:10px; text-decoration:none; color:var(--text); }
    .dropdown-item:hover { background:#f9fafb; }
    .badge { font-size:11px; padding:2px 6px; border:1px solid var(--border); border-radius:8px; margin-left:6px; background:#f1f5f9; }
    .pill { display:inline-block; background:#ecfdf5; color:#065f46; padding:2px 8px; border-radius:999px; font-size:12px; border:1px solid #a7f3d0; }
    .grid3 { display:grid; grid-template-columns:repeat(3,1fr); gap:12px; }
    .quiz-card h3 { margin-top:0; }
    .quiz-q { border:1px solid var(--border); padding:10px; border-radius:12px; }
    .quiz-actions { display:flex; gap:8px; align-items:center; }
    .ok { color:#166534; font-weight:700; }
    .err { color:#b91c1c; font-weight:700; }
    .nav-right a, .nav-right button { white-space:nowrap; }
    @media (max-width: 680px){
      .grid3{grid-template-columns:1fr}
      .dropdown-menu{right:auto; left:0;}
    }
  </style>
</head>
<body>
  <!-- NAV -->
  <header class="topbar">
    <div class="topbar-inner">
      <div class="brand-left" onclick="location.hash='#/home'">
        <div class="logo-square"><span>‚ó¥</span></div>
        <div class="brand-text"><span class="brand-strong">Samriddhi</span></div>
      </div>
      <nav class="nav-right">
        <div class="dropdown" id="programsDropdown">
          <span class="nav-link dropdown-toggle">Programs ‚ñæ</span>
          <div class="dropdown-menu" aria-label="Programs menu">
            <a class="dropdown-item" href="#/modules">üìö All programs</a>
            <a class="dropdown-item" href="#/modules#quiz">üìù Take a quiz <span class="badge">new</span></a>
          </div>
        </div>
        <a class="nav-link" href="#/banking">Banking <span class="chip-new">NEW</span></a>
        <a class="nav-link" href="#/dashboard">Toolkit</a>
        <button id="btnOpenLogin" class="btn login-pill">Login/Register</button>
        <a id="navProfile" class="nav-link hidden" href="#/profile">Profile</a>
      </nav>
    </div>
  </header>

  <!-- HOME -->
  <main class="container" id="page-home">
    <section class="hero card">
      <div class="hero-text">
        <h1>Grow your tailoring business with confidence</h1>
        <p class="muted">
          Samriddhi offers practical video lessons, simple calculators and access to partner
          banking products‚Äîdesigned for women entrepreneurs in small towns and villages.
        </p>
        <div class="row gap">
          <button class="btn primary" id="btnStart">Get Started</button>
          <a class="btn ghost" href="#/modules">Browse Programs</a>
        </div>
      </div>
      <div class="hero-art"></div>
    </section>
    <section class="features">
      <div class="feature card">
        <h3>Learn by doing</h3>
        <p class="muted">Short, structured lessons in local languages with hands-on activities.</p>
      </div>
      <div class="feature card">
        <h3>Bank with ease</h3>
        <p class="muted">Open accounts and explore loans with our small-finance bank partners.</p>
      </div>
      <div class="feature card">
        <h3>Operate smart</h3>
        <p class="muted">Track costs, set prices, and plan profit using built-in tools.</p>
      </div>
    </section>
  </main>

  <!-- LOGIN (phone only) -->
  <main class="container hidden" id="page-login">
    <section class="login card">
      <h2>What's your mobile number?</h2>
      <p class="muted">Please enter your Aadhaar-linked mobile number</p>
      <div class="phone-input">
        <div class="phone-cc">+91</div>
        <input id="phoneNumber" inputmode="numeric" pattern="[0-9]*" maxlength="10" placeholder="0000000000"/>
      </div>
      <p class="tiny muted">By proceeding, you agree to <a href="#">T&amp;C</a> &amp; <a href="#">Privacy Policy</a></p>
      <button id="btnProceedPhone" class="btn primary wide">Proceed</button>
      <p class="tiny muted">Demo mode: any 10-digit number will continue.</p>
    </section>
  </main>

  <!-- MODULES (recommendation style list) -->
  <main class="container hidden" id="page-modules">
    <section class="modules-grid">
      <aside class="left-rail card">
        <div class="rail-header">
          <span class="crumb">Home</span> / <span class="crumb strong">Programs</span>
        </div>
        <ol class="steps">
          <li class="done">Pick a track</li>
          <li class="done">Set your goals</li>
          <li class="active">Review recommended content</li>
        </ol>
        <button class="btn ghost small" id="btnExitGuide">Go to Dashboard</button>
        <div style="margin-top:12px">
          <span class="pill">Now with Quiz</span>
        </div>
      </aside>
      <section class="recos card">
        <div class="recos-head">
          <h2>Recommended course content</h2>
          <div class="save-indicator">Saved ‚Ä¢ Total length: <span id="totalLen">0m</span></div>
        </div>
        <div id="moduleList" class="module-sections"></div>

        <!-- QUIZ -->
        <section id="quiz" class="quiz-card card" style="margin-top:12px">
          <h3>Quick quiz: Basics of Tailoring Business</h3>
          <p class="muted">Answer 3 questions to check your understanding.</p>
          <div id="quizBox" class="grid3"></div>
          <div class="quiz-actions" style="margin-top:10px">
            <button id="submitQuiz" class="btn primary">Submit quiz</button>
            <button id="resetQuiz" class="btn ghost">Reset</button>
            <span id="quizResult" class="muted"></span>
          </div>
        </section>
      </section>
    </section>
  </main>

  <!-- BANKING -->
  <main class="container hidden" id="page-banking">
    <section class="bank-wrap">
      <div class="bank-hero card">
        <img class="bank-img" alt="Bank" src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjYwMCI+CiAgPGRlZnM+CiAgICA8bGluZWFyR3JhZGllbnQgaWQ9ImciIHgxPSIwIiB4Mj0iMSIgeTE9IjAiIHkyPSIxIj4KICAgICAgPHN0b3Agb2Zmc2V0PSIwJSIgc3RvcC1jb2xvcj0iIzE2YTM0YSIvPgogICAgICA8c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiMyMmM1NWUiLz4KICAgIDwvbGluZWFyR3JhZGllbnQ+CiAgPC9kZWZzPgogIDxyZWN0IHdpZHRoPSIxMjAwIiBoZWlnaHQ9IjYwMCIgZmlsbD0idXJsKCNnKSIvPgogIDxnIGZvbnQtZmFtaWx5PSJBcmlhbCwgSGVsdmV0aWNhLCBzYW5zLXNlcmlmIiBmaWxsPSIjZmZmZmZmIiBmb250LXNpemU9IjY0Ij4KICAgIDx0ZXh0IHg9IjYwIiB5PSIxMTAiPlNBTVJJRERISSBCQU5LSU5HPC90ZXh0PgogIDwvZz4KICA8ZyBmaWxsPSIjZmZmZmZmIj4KICAgIDxyZWN0IHg9IjcwIiB5PSIxNjAiIHdpZHRoPSI0MjAiIGhlaWdodD0iMzAwIiByeD0iMTYiIG9wYWNpdHk9IjAuMTUiLz4KICAgIDxyZWN0IHg9IjUyMCIgeT0iMTYwIiB3aWR0aD0iNDIwIiBoZWlnaHQ9IjMwMCIgcng9IjE2IiBvcGFjaXR5PSIwLjE1Ii8+CiAgICA8cmVjdCB4PSI5NzAiIHk9IjE2MCIgd2lkdGg9IjE2MCIgaGVpZ2h0PSIzMDAiIHJ4PSIxNiIgb3BhY2l0eT0iMC4xNSIvPgogIDwvZz4KPC9zdmc+"/>
        <aside class="calc card">
          <h3 class="calc-title">Fixed Deposit Calculator</h3>
          <div class="grid2">
            <label>Amount (‚Çπ)<input id="invAmount" type="number" value="100000"/></label>
            <label>Sr. Citizen
              <select id="srCitizen"><option>No</option><option>Yes</option></select>
            </label>
          </div>
          <label>Interest rate and tenure
            <select id="tenurePick">
              <option value="60|8.2">5Y (8.2%)</option>
              <option value="36|7.6">3Y (7.6%)</option>
              <option value="12|7.0">1Y (7.0%)</option>
            </select>
          </label>
          <div class="facts">
            <div class="fact"><span>Investment amount</span><strong id="fInv">‚Çπ1,00,000</strong></div>
            <div class="fact"><span>Compounding</span><strong>Quarterly</strong></div>
            <div class="fact"><span>FD rate applicable</span><strong id="fRate">8.2%</strong></div>
            <div class="fact"><span>FD tenure</span><strong id="fTenure">5Y</strong></div>
            <div class="fact"><span>Maturity amount</span><strong id="fMaturity">‚Çπ‚Äî</strong></div>
          </div>
          <div class="grid2" style="margin-top:8px">
            <a class="btn ghost" href="#/open-account">Open an account</a>
            <a class="btn primary" href="#/loan">Apply for a loan</a>
          </div>
        </aside>
      </div>
    </section>
  </main>

  <!-- OPEN ACCOUNT (demo form) -->
  <main class="container hidden" id="page-open-account">
    <section class="card">
      <h2>Open an Account (Demo)</h2>
      <p class="muted">Fill the basic details and submit to proceed. This is a demo flow; no data is stored on a server.</p>
      <div class="grid3" style="gap:8px">
        <label>Full name<input id="acc_name" placeholder="e.g., Sita Devi"/></label>
        <label>Village / City<input id="acc_city" placeholder="e.g., Murbad"/></label>
        <label>PAN (optional)<input id="acc_pan" placeholder="ABCDE1234F"/></label>
      </div>
      <div class="grid2" style="gap:8px; margin-top:8px">
        <label>Initial deposit (‚Çπ)<input id="acc_amt" type="number" value="5000"/></label>
        <label>Account type
          <select id="acc_type"><option>Basic Savings</option><option>Regular Savings</option></select>
        </label>
      </div>
      <div style="margin-top:12px; display:flex; gap:8px">
        <button id="acc_submit" class="btn primary">Submit</button>
        <a class="btn ghost" href="#/banking">Back to Banking</a>
        <span id="acc_msg" class="muted"></span>
      </div>
    </section>
  </main>

  <!-- LOAN (demo form) -->
  <main class="container hidden" id="page-loan">
    <section class="card">
      <h2>Apply for a Micro-Loan (Demo)</h2>
      <p class="muted">Enter loan request details. Demo flow approves if inputs are valid.</p>
      <div class="grid3" style="gap:8px">
        <label>Loan amount (‚Çπ)<input id="loan_amt" type="number" value="25000"/></label>
        <label>Purpose
          <select id="loan_purpose">
            <option>Sewing Machine</option>
            <option>Shop Renovation</option>
            <option>Working Capital</option>
          </select>
        </label>
        <label>Tenure (months)
          <select id="loan_tenure">
            <option>12</option><option>18</option><option>24</option>
          </select>
        </label>
      </div>
      <div class="grid2" style="gap:8px; margin-top:8px">
        <label>Monthly income (‚Çπ)<input id="loan_income" type="number" value="15000"/></label>
        <label>Existing EMIs (‚Çπ)<input id="loan_emi" type="number" value="0"/></label>
      </div>
      <div style="margin-top:12px; display:flex; gap:8px">
        <button id="loan_submit" class="btn primary">Check Eligibility</button>
        <a class="btn ghost" href="#/banking">Back to Banking</a>
        <span id="loan_msg" class="muted"></span>
      </div>
    </section>
  </main>

  <!-- DASHBOARD -->
  <main class="container hidden" id="page-dashboard">
    <section class="card">
      <h2>Welcome to your dashboard</h2>
      <p class="muted">You're logged in (demo session). Explore <a href="#/modules">programs</a> or go to <a href="#/banking">banking</a>.</p>
    </section>
  </main>

  <!-- PROFILE -->
  <main class="container hidden" id="page-profile">
    <section class="card">
      <h2>Your Profile</h2>
      <p class="muted">Manage your details. This is stored in your browser only (demo).</p>
      <div class="grid3" style="gap:8px">
        <label>Phone (read-only)<input id="prof_phone" disabled/></label>
        <label>Name<input id="prof_name" placeholder="Your name"/></label>
        <label>Village / City<input id="prof_city" placeholder="Your town"/></label>
      </div>
      <div class="grid2" style="gap:8px; margin-top:8px">
        <label>Occupation<input id="prof_job" placeholder="e.g., Tailor"/></label>
        <label>Language
          <select id="prof_lang"><option>English</option><option>Hindi</option><option>Marathi</option><option>Bengali</option></select>
        </label>
      </div>
      <div style="margin-top:12px; display:flex; gap:8px; align-items:center">
        <button id="prof_save" class="btn primary">Save</button>
        <button id="prof_logout" class="btn ghost">Log out</button>
        <span id="prof_msg" class="muted"></span>
      </div>
    </section>
  </main>

  <footer class="tiny muted center">¬© Samriddhi</footer>

  <script>
    // Helpers
    const $ = (s)=>document.querySelector(s);
    const $$ = (s)=>document.querySelectorAll(s);

    // Client-side routes
    const pages = ['home','login','modules','banking','dashboard','open-account','loan','profile'];
    function show(page){
      pages.forEach(p=>document.querySelector('#page-'+p)?.classList.add('hidden'));
      document.querySelector('#page-'+page)?.classList.remove('hidden');
      const newHash = '#/'+page;
      if(location.hash !== newHash) window.location.hash = newHash;
    }
    window.addEventListener('hashchange', ()=>{
      const hash = location.hash;
      const raw = hash.replace('#/','') || 'home';
      const parts = raw.split('#');
      const p = parts[0];
      const frag = parts[1];
      if(pages.includes(p)) show(p);
      if(p==='modules' && frag==='quiz'){
        setTimeout(()=>document.getElementById('quiz')?.scrollIntoView({behavior:'smooth'}),0);
      }
    });

    // Dropdown menu behavior
    const dd = $('#programsDropdown');
    dd.querySelector('.dropdown-toggle').addEventListener('click', ()=> dd.classList.toggle('open'));
    document.addEventListener('click', (e)=>{
      if(!dd.contains(e.target)) dd.classList.remove('open');
    });

    // CTA -> Phone login
    $('#btnStart').onclick = ()=> show('login');
    $('#btnOpenLogin').onclick = ()=> show('login');

    // Phone-only login (demo)
    $('#btnProceedPhone').onclick = ()=>{
      const ph = ($('#phoneNumber').value || '').replace(/\D/g,'');
      if(ph.length !== 10){ alert('Enter a valid 10-digit mobile number'); return; }
      const profile = JSON.parse(localStorage.getItem('sam_profile')||'{}');
      const session = { phone: ph, ...profile };
      localStorage.setItem('sam_session', JSON.stringify(session));
      $('#navProfile').classList.remove('hidden');
      show('modules');
    };

    // Exit guide button -> Dashboard
    $('#btnExitGuide').onclick = ()=> show('dashboard');

    // --- Modules (recommendation-style UI) ---
    const modules = [
      {title: 'Introduction to Tailoring', minutes: 60, items: [
        { type:'video', title:'Welcome & safety', mins:6 },
        { type:'video', title:'Understanding your machine', mins:12 },
        { type:'video', title:'Threads & needles', mins:10 },
        { type:'reading', title:'Finding fabric locally', mins:6 },
        { type:'video', title:'Your first stitch', mins:10 },
        { type:'video', title:'Care & maintenance', mins:16 }
      ]},
      {title: 'Business Basics', minutes: 30, items: [
        { type:'video', title:'Pricing a blouse', mins:12 },
        { type:'video', title:'Managing orders', mins:8 },
        { type:'reading', title:'Keeping a cashbook', mins:10 }
      ]}
    ];

    function renderModules(){
      const host = $('#moduleList'); host.innerHTML='';
      let total = 0;
      modules.forEach((mod, idx)=>{
        total += mod.minutes;
        const sec = document.createElement('section');
        sec.className = 'module-sec';
        sec.innerHTML = `
          <div class="sec-head">
            <div>
              <button class="collapse-btn" data-i="${idx}" aria-expanded="false" aria-controls="items-${idx}">‚ñ∏</button>
              <span class="sec-title">${idx+1}. ${mod.title}</span>
            </div>
            <span class="muted">${mod.minutes}m</span>
          </div>
          <div class="items hidden" id="items-${idx}"></div>
        `;
        host.appendChild(sec);
        const items = sec.querySelector('.items');
        mod.items.forEach(it=>{
          const row = document.createElement('div');
          row.className = 'item-row';
          row.innerHTML = `
            <div class="left">
              <span class="ic">${it.type==='video'?'‚ñ∂':'üìÑ'}</span>
              <div class="it-title">${it.title}</div>
            </div>
            <div class="right">
              <span class="muted">${it.mins}m</span>
              <button class="ghost-icon" title="Move">‚ò∞</button>
              <button class="ghost-icon" title="Edit">‚úé</button>
            </div>
          `;
          items.appendChild(row);
        });
      });
      $('#totalLen').textContent = total + 'm';
      $$('.collapse-btn').forEach(btn=>{
        btn.onclick = (e)=>{
          const i = e.currentTarget.getAttribute('data-i');
          const box = document.querySelector('#items-'+i);
          const isHidden = box.classList.toggle('hidden');
          e.currentTarget.textContent = isHidden ? '‚ñ∏' : '‚ñæ';
          e.currentTarget.setAttribute('aria-expanded', String(!isHidden));
        };
      });
    }
    renderModules();

    // --- Quiz ---
    const quizQ = [
      { q:'What is the best way to record daily cash?', opts:['Memory','Cashbook','Bank passbook'], ans:1 },
      { q:'Which cost should be included in blouse price?', opts:['Thread only','Fabric only','All materials & time'], ans:2 },
      { q:'How often to service machine?', opts:['Never','When broken','Regularly as per manual'], ans:2 }
    ];
    function renderQuiz(){
      const box = $('#quizBox'); box.innerHTML='';
      quizQ.forEach((it, i)=>{
        const card = document.createElement('div');
        card.className='quiz-q';
        card.innerHTML = `
          <div style="font-weight:700;margin-bottom:6px">${i+1}. ${it.q}</div>
          ${it.opts.map((o, j)=>`
            <label style="display:flex;gap:8px;align-items:center;margin:4px 0">
              <input type="radio" name="q${i}" value="${j}"/> <span>${o}</span>
            </label>
          `).join('')}
        `;
        box.appendChild(card);
      });
    }
    renderQuiz();

    $('#submitQuiz').onclick = ()=>{
      let score = 0;
      quizQ.forEach((it, i)=>{
        const sel = document.querySelector('input[name="q'+i+'"]:checked');
        if(sel && Number(sel.value) === it.ans) score++;
      });
      const res = $('#quizResult');
      res.innerHTML = (score===quizQ.length)
        ? '<span class="ok">Perfect! '+score+'/'+quizQ.length+'</span>'
        : '<span class="err">Score: '+score+'/'+quizQ.length+' ‚Äî review and try again.</span>';
      localStorage.setItem('sam_quiz_score', String(score));
    };
    $('#resetQuiz').onclick = ()=>{ renderQuiz(); $('#quizResult').textContent=''; localStorage.removeItem('sam_quiz_score'); };

    // --- Banking calc (quarterly compounding) ---
    function calcMaturity(principal, ratePct, months){
      const qRate = ratePct/100/4;
      const years = months/12;
      const A = principal * Math.pow(1 + qRate, 4*years);
      return Math.round(A);
    }
    function updateFacts(){
      const parts = $('#tenurePick').value.split('|').map(Number);
      const months = parts[0]; const rate = parts[1];
      const amt = Number($('#invAmount').value||0);
      $('#fInv').textContent = '‚Çπ' + amt.toLocaleString('en-IN');
      $('#fRate').textContent = rate + '%';
      $('#fTenure').textContent = (months/12) + 'Y';
      const mat = calcMaturity(amt, rate, months);
      $('#fMaturity').textContent = '‚Çπ' + mat.toLocaleString('en-IN');
    }
    $('#tenurePick').onchange = updateFacts;
    $('#invAmount').oninput = updateFacts;
    updateFacts();

    // --- Open Account (demo) ---
    $('#acc_submit').onclick = ()=>{
      const name=$('#acc_name').value.trim();
      const city=$('#acc_city').value.trim();
      const amt=Number($('#acc_amt').value||0);
      if(!name || !city || amt<0){ $('#acc_msg').textContent='Please fill all required details.'; return; }
      $('#acc_msg').innerHTML='<span class="ok">Account request submitted. Ref: ACC'+Math.floor(Math.random()*99999)+'</span>';
      setTimeout(()=> show('dashboard'), 900);
    };

    // --- Loan (demo) ---
    $('#loan_submit').onclick = ()=>{
      const A=Number($('#loan_amt').value||0);
      const I=Number($('#loan_income').value||0);
      const E=Number($('#loan_emi').value||0);
      if(A<1000 || I<=0 || E<0){ $('#loan_msg').textContent='Check numbers and try again.'; return; }
      // Simple eligibility rule: EMI <= 35% of income
      const r = 0.20/12; // demo nominal rate 20% p.a.
      const n = Number($('#loan_tenure').value);
      const emi = A * r * Math.pow(1+r, n) / (Math.pow(1+r, n)-1);
      const ok = (emi + E) <= 0.35 * I;
      $('#loan_msg').innerHTML = ok
        ? '<span class="ok">Eligible. Est. EMI ‚Çπ'+Math.round(emi).toLocaleString('en-IN')+'. Reference LOAN'+Math.floor(Math.random()*99999)+'</span>'
        : '<span class="err">Not eligible at current income/EMIs. Try lower amount or longer tenure.</span>';
      if(ok) setTimeout(()=> show('dashboard'), 1200);
    };

    // --- Profile ---
    function loadProfileUI(){
      const sess = JSON.parse(localStorage.getItem('sam_session')||'{}');
      $('#prof_phone').value = sess.phone || '';
      $('#prof_name').value = sess.name || '';
      $('#prof_city').value = sess.city || '';
      $('#prof_job').value = sess.job || '';
      $('#prof_lang').value = sess.lang || 'English';
    }
    $('#prof_save').onclick = ()=>{
      const sess = JSON.parse(localStorage.getItem('sam_session')||'{}');
      const updated = {
        ...sess,
        name: $('#prof_name').value.trim(),
        city: $('#prof_city').value.trim(),
        job: $('#prof_job').value.trim(),
        lang: $('#prof_lang').value
      };
      localStorage.setItem('sam_session', JSON.stringify(updated));
      localStorage.setItem('sam_profile', JSON.stringify(updated));
      $('#prof_msg').innerHTML = '<span class="ok">Saved.</span>';
    };
    $('#prof_logout').onclick = ()=>{
      localStorage.removeItem('sam_session');
      $('#navProfile').classList.add('hidden');
      show('home');
    };

    // Initial route & nav state
    function init(){
      if(localStorage.getItem('sam_session')){
        $('#navProfile').classList.remove('hidden');
      }
      const raw = location.hash.replace('#/','') || 'home';
      const p = raw.split('#')[0];
      show(pages.includes(p) ? p : 'home');
    }
    init();

    // When entering profile route, populate fields
    const ro = new MutationObserver(()=>{
      if(!$('#page-profile').classList.contains('hidden')) loadProfileUI();
    });
    ro.observe(document.body, {subtree:true, attributes:true, attributeFilter:['class']});
  </script>
</body>
</html>
